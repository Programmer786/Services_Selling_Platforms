<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Services Selling Platforms</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	
	<!-- ================== BEGIN core-css ================== -->
	<link rel="stylesheet" href="{{ url_for('static', filename='css/vendor.min.css') }}" type="text/css" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/app.customer.min.css') }}" type="text/css" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}" type="text/css" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/for_gig.css') }}" type="text/css" />
	<!-- ================== END core-css ================== -->
	<style>
		.desc {
			overflow: hidden;
			text-overflow: ellipsis;
			display: -webkit-box;
			-webkit-line-clamp: 2; /* Limits the text to 2 lines */
			-webkit-box-orient: vertical;
		}

		.cart-descriptio-text{
			overflow: hidden;
			text-overflow: ellipsis;
			display: -webkit-box;
			-webkit-line-clamp: 2; /* Limits the text to 2 lines */
			-webkit-box-orient: vertical;
		}
	</style>


  
	
  
</head>
<body class='pace-top'>
	<!-- BEGIN #app -->
	<div id="app" class="app app-content-full-height app-without-sidebar">
		<!-- BEGIN #header -->
		{% include "Customer/_Header.html" %}
		<!-- END #header -->
		<!-- BEGIN #content -->
		<div id="content" class="app-content p-0">
			<!-- BEGIN pos -->
			<div class="pos" id="pos">
				<div class="pos-container">
          <!-- BEGIN pos-content -->
          <div class="pos-content">
            <div class="pos-content-container h-100">
              <!--banner section start -->
              <div class="banner_section layout_padding">
                <!-- BEGIN Message-Show -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                  {% if messages %}
                    {% for category, message in messages %}
                      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        <strong>{{ category|capitalize }}!</strong> {{ message|capitalize }}.
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                      </div>
                    {% endfor %}
                  {% endif %}
                {% endwith %}
                <!-- End Message-Show -->

                <!-- <div class="container"> -->
                  <div class="row">
                    <div class="col-md-12">
                      <div class="slider-hero">
                        <div class="featured-carousel owl-carousel">
                          <div class="item" id="slider-1">
                            <div class="work">
                              <div class="img d-flex align-items-center justify-content-center" style="background-image: url({{ url_for('static', filename='carousel/images/slider-1.jpg') }})">
                                <div class="text text-center">
                                  <h2 class="banner_taital" style="color: #ffffff !important; font-weight: bold; font-size: 100px !important;">Professional <span style="color: #ecad15; font-weight: bold; font-size: 100px !important;">Painting</span></h2>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="item" id="slider-2">
                            <div class="work">
                              <div class="img d-flex align-items-center justify-content-center" style="background-image: url({{ url_for('static', filename='carousel/images/slider-2.jpg') }})">
                                <div class="text text-center">
                                  <h2 class="banner_taital" style="color: #ffffff !important; font-weight: bold; font-size: 100px !important;">Professional <span style="color: #ecad15; font-weight: bold; font-size: 100px !important;">Designing</span></h2>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="item" id="slider-3">
                            <div class="work">
                              <div class="img d-flex align-items-center justify-content-center" style="background-image: url({{ url_for('static', filename='carousel/images/slider-3.jpg') }})">
                                <div class="text text-center">
                                  <h2 class="banner_taital" style="color: #ffffff !important; font-weight: bold; font-size: 100px !important;">Professional <span style="color: #ecad15; font-weight: bold; font-size: 100px !important;">Photographer</span></h2>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      
                        <div class="my-5 text-center">
                          <ul class="thumbnail">
                            <li class="active img"><a href="#" data-target="#slider-1"><img src="{{ url_for('static', filename='carousel/images/slider-1.jpg') }}" alt="Image" class="img-fluid"></a></li>
                            <li><a href="#" data-target="#slider-2"><img src="{{ url_for('static', filename='carousel/images/slider-2.jpg') }}" alt="Image" class="img-fluid"></a></li>
                            <li><a href="#" data-target="#slider-3"><img src="{{ url_for('static', filename='carousel/images/slider-3.jpg') }}" alt="Image" class="img-fluid"></a></li>
                          </ul>
                        </div>
                      </div>
                      
                    </div>
                  </div>
                <!-- </div> -->
              </div>
              <!--banner section end -->
              
              <!-- Container for all gig cards -->
              <div class="gig-cards-container">
                <div class="row">
                  {% for artist in all_artist %}
                  <!-- Gig card 1 -->
                  <div class="col-md-3">
                      <div class="gig-card">
                          <a href="/pos_customer_order/{{ artist.user_id }}">
                              <div class="gig-image">
                                  {% if artist.photo %}
                                  <img src="{{ url_for('static', filename='uploaded_files/' + artist.photo) }}" style="width: 100%; height: 400px;" alt="Artist Photo">
                                  {% else %}
                                  <img src="{{ url_for('static', filename='picked/images/client-img.png') }}" style="width: 100%; height: 400px;" alt="Artist Photo">
                                  {% endif %}
                              </div>
                              <div class="gig-info">
                                  <div class="seller-info">
                                      {% if artist.photo %}
                                      <img src="{{ url_for('static', filename='uploaded_files/' + artist.photo) }}" alt="Seller Image" class="seller-image">
                                      {% else %}
                                      <img src="{{ url_for('static', filename='picked/images/client-img.png') }}" alt="Seller Image" class="seller-image">
                                      {% endif %}
                                      <span class="seller-name">{{ artist.full_name }}</span>
                                  </div>
                                  <h3 class="gig-title">I am {{ artist.user_name }} and you can contact me at {{ artist.phone }}</h3>
                                  <div class="gig-rating">
                                      <span class="stars">
                                          {% for i in range(artist_ratings[artist.user_id] | round | int) %}

                                          ‚≠ê
                                          {% endfor %}
                                      </span>
                                      <span class="rating-count">({{ artist_ratings[artist.user_id] | round(1) }})</span>
                                  </div>
                                  <div class="buy_bt_2">
                                      <a href="#" id="buy_bt_2" data-bs-toggle="modal" data-bs-target="#contactMeModal{{artist.user_id}}">Contact Me</a>
                                  </div>
                                  {% if session.cust_RolName %}
                                  <div class="buy_bt_3">
                                      <a href="#" id="buy_bt_3" data-bs-toggle="modal" data-bs-target="#makeReportModal{{artist.user_id}}">Report</a>
                                  </div>
                                  {% endif %}
                              </div>
                          </a>
                      </div>
                  </div>
                  <!-- Repeat the gig card structure for more cards -->
              

                  <!-- Add a modal for Make Report -->
                  <div class="modal fade" id="makeReportModal{{artist.user_id}}">
                    <div class="modal-dialog">
                      <div class="modal-content">
                        <form action="{{url_for('make_report', Report_Id=artist.user_id)}}" method="post">
                          <div class="modal-header">
                            <h5 class="modal-title">Make Report</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                          </div>
                          <div class="modal-body">
                            <div class="form-group mt-2">
                              <label for="selectReason" style="color: black;"><b>Select Reason *</b></label>
                              <select class="form-control" id="selectReason" name="select_reason" required>
                                <option value="" disabled selected>Select a reason</option>
                                <option value="Spam">Spam</option>
                                <option value="Inappropriate Content">Inappropriate Content</option>
                                <option value="Harassment">Harassment</option>
                                <option value="Violence">Violence</option>
                                <option value="Other">Other</option>
                              </select>
                            </div>
                            <div class="form-group mt-2">
                              <label for="reportMessage" style="color: black;"><b>Report Message *</b></label>
                              <input type="text" class="form-control" id="reportMessage" name="report_message" placeholder="Report Message" required/>
                            </div>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary btn-md"><b>Make Report</b></button>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                  <!-- End Modal for Make Report -->

                  <!-- Modal for Chat System -->
                  <div class="modal fade" id="contactMeModal{{artist.user_id}}">
                    <div class="modal-dialog modal-lg modal-dialog-centered">
                        <div class="modal-content">
                            <!-- Modal Header -->
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title">Chat with {{ artist.full_name }}</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>

                            <!-- Modal Body (Chat Box) -->
                            <div class="modal-body p-0">
                                <div class="chat-box">
                                    <!-- Chat Messages -->
                                    <div class="chat-messages px-4 py-3" id="chatMessages{{artist.user_id}}" style="max-height: 400px; overflow-y: auto;">
                                        <!-- Chat messages will be appended here -->
                                    </div>
                                    
                                    <!-- Chat Input -->
                                    <div class="chat-input-container bg-light p-3 border-top">
                                        <div class="d-flex">
                                            <input type="hidden" id="SenderID{{artist.user_id}}" value="{{session.Cust_Id}}">
                                            <input type="hidden" id="ReceiverID{{artist.user_id}}" value="{{artist.user_id}}">
                                            <input type="text" id="chatInput{{artist.user_id}}" class="form-control me-2" placeholder="Type a message...">
                                            <button type="button" id="sendMessageButton{{artist.user_id}}" class="btn btn-primary">
                                                <i class="fas fa-paper-plane"></i> Send
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                  </div>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
          <!-- END pos-content -->
				</div>
			</div>
			<!-- END pos -->
			
			<!-- BEGIN pos-mobile-sidebar-toggler -->
			<a class="pos-mobile-sidebar-toggler" data-toggle-class="pos-mobile-sidebar-toggled" data-toggle-target="#pos">
				<i class="fa fa-shopping-bag"></i>
				<span class="badge">{{ session.get('cart_items1', []) | length }}</span>
			</a>
			<!-- END pos-mobile-sidebar-toggler -->
		</div>
		<!-- END #content -->
		
		<!-- BEGIN btn-scroll-top -->
		<a href="#" data-click="scroll-top" class="btn-scroll-top fade"><i class="fa fa-arrow-up"></i></a>
		<!-- END btn-scroll-top -->
	</div>
	<!-- END #app -->

	
	<!-- ================== BEGIN core-js ================== -->
	<script src="{{ url_for('static', filename='js/vendor.min.js') }}"></script>
	<script src="{{ url_for('static', filename='js/app.min.js') }}"></script>
	<!-- ================== END core-js ================== -->

	<!-- ================== BEGIN use for add to card data ================== -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<!-- ================== END BEGIN use for add to card data ================== -->

	<!-- ================== BEGIN page-js ================== -->
	<script src="{{ url_for('static', filename='js/demo/pos-customer-order.demo.js') }}"></script>
	<!-- ================== END page-js ================== -->
	<!-- ================== BEGIN page-js ================== -->
	<script src="{{ url_for('static', filename='plugins/@highlightjs/cdn-assets/highlight.min.js') }}"></script>
	<script src="{{ url_for('static', filename='js/demo/highlightjs.demo.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net/js/jquery.dataTables.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-bs5/js/dataTables.bootstrap5.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-buttons/js/dataTables.buttons.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-buttons/js/buttons.colVis.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-buttons/js/buttons.flash.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-buttons/js/buttons.html5.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-buttons/js/buttons.print.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-buttons-bs5/js/buttons.bootstrap5.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-responsive/js/dataTables.responsive.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/datatables.net-responsive-bs5/js/responsive.bootstrap5.min.js') }}"></script>
	<script src="{{ url_for('static', filename='plugins/bootstrap-table/dist/bootstrap-table.min.js') }}"></script>
	<script src="{{ url_for('static', filename='js/demo/table-plugins.demo.js') }}"></script>
	<script src="{{ url_for('static', filename='js/demo/sidebar-scrollspy.demo.js') }}"></script>
	<!-- ================== END page-js ================== -->
	<script>
		$(document).ready(function() {
			$('.add_for_download').click(function(event) {
				event.preventDefault(); // Prevent the default behavior of the anchor tag

				// Check if the user is logged in
				if (isLoggedIn()) {
					var productId = $(this).data('product-id');
					$.ajax({
						type: 'POST',
						url: '/add_to_download_verification',
						data: { product_id: productId },
						success: function(response) {
							console.log(response);
							location.reload(); // Reload the page on success
						},
						error: function(xhr, status, error) {
							console.error(xhr.responseText);
							location.reload(); // Reload the page on error
						}
					});
				} else {
					// Redirect the user to the login page
					window.location.href = '/cust_login'; 
				}
			});
		});

		// Function to check if the user is logged in
		function isLoggedIn() {
			// Implement your logic to check if the user is logged in here
			// For example, you can check if the session variables are set
			return '{{ session.Cust_Id }}' !== '' && '{{ session.Cust_Phone }}' !== '';
		}
	</script>
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const searchInput = document.getElementById('searchInput');
			const artistItems = document.querySelectorAll('.artist-item');
			const productItems = document.querySelectorAll('.product-item');

			searchInput.addEventListener('input', function () {
				const query = searchInput.value.toLowerCase();

				// Filter artist items
				artistItems.forEach(function (item) {
					const name = item.getAttribute('data-name').toLowerCase();
					const phone = item.getAttribute('data-phone').toLowerCase();
					const gender = item.getAttribute('data-gender').toLowerCase();

					if (name.includes(query) || phone.includes(query) || gender.includes(query)) {
						item.style.display = 'block';
					} else {
						item.style.display = 'none';
					}
				});

				// Filter product items
				productItems.forEach(function (item) {
					const name = item.getAttribute('data-name').toLowerCase();
					const desc = item.getAttribute('data-desc').toLowerCase();

					if (name.includes(query) || desc.includes(query)) {
						item.style.display = 'block';
					} else {
						item.style.display = 'none';
					}
				});
			});
		});


	</script>

<!-- This is for thumbnail -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const thumbnails = document.querySelectorAll('.thumbnail li a');
    const sliderItems = document.querySelectorAll('.featured-carousel .item');

    thumbnails.forEach(thumbnail => {
      thumbnail.addEventListener('click', function(event) {
        event.preventDefault();

        // Remove active class from all thumbnails
        thumbnails.forEach(thumb => thumb.parentElement.classList.remove('active'));

        // Add active class to the clicked thumbnail
        this.parentElement.classList.add('active');

        // Get the target slider item
        const targetId = this.getAttribute('data-target');
        const targetItem = document.querySelector(targetId);

        // Hide all slider items
        sliderItems.forEach(item => item.style.display = 'none');

        // Show the target slider item
        targetItem.style.display = 'block';
      });
    });

    // Initially show the first slider item
    sliderItems.forEach((item, index) => {
      if (index === 0) {
        item.style.display = 'block';
      } else {
        item.style.display = 'none';
      }
    });
  });
</script>

<!-- This is for chat -->
<script>
  $(document).ready(function() {
      // Function to load messages
      function loadMessages(senderId, receiverId) {
          $.get(`/get_messages/${senderId}/${receiverId}`, function(data) {
              if (data.success) {
                  const chatMessages = $(`#chatMessages${receiverId}`);
                  chatMessages.empty();
                  data.messages.forEach(msg => {
                      const messageClass = msg.sender_id == senderId ? 'sent' : 'received';
                      chatMessages.append(`
                          <div class="${messageClass}">
                              <p>${msg.message}</p>
                              <small>${msg.timestamp}</small>
                          </div>
                      `);
                  });
              }
          });
      }

      // Send message
      $('[id^=sendMessageButton]').click(function() {
          const receiverId = $(this).attr('id').replace('sendMessageButton', '');
          const senderId = $(`#SenderID${receiverId}`).val();
          const message = $(`#chatInput${receiverId}`).val();

          $.post('/send_message', { sender_id: senderId, receiver_id: receiverId, message: message }, function(data) {
              if (data.success) {
                  loadMessages(senderId, receiverId);
                  $(`#chatInput${receiverId}`).val('');
              }
          });
      });

      // Load messages when modal is opened
      $('[id^=contactMeModal]').on('shown.bs.modal', function() {
          const receiverId = $(this).attr('id').replace('contactMeModal', '');
          const senderId = $(`#SenderID${receiverId}`).val();
          loadMessages(senderId, receiverId);
      });
  });
</script>
</body>
</html>
